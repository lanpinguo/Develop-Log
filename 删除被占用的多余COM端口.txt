在Windows的设备管理器中，发现每次接入CP210x设备后，系统自动分配的COM编号比较大，该如何删除被占用的多余COM端口？

答案
除了CP2102型号以外，其它CP210x型号产品的芯片内部自带一个唯一的序列号。而Windows系统是依据所接入的USB设备的VID、PID以及序列号三者组合的不同而分配不同的COM口编号，同款CP210x芯片使用的VID/PID完全相同。从而导致系统在每次检测到新CP210x设备序列号接入后便会自动根据当前已占用的COM口编号递增分配新的COM口编号。后续即使设备已被拔出，所分配的COM端口在该系统上仍然处于被占用的隐藏状态，由此产生了许多被占用的多余的COM端口。下面以Windows 7为例，介绍如何显示并删除隐藏的设备。

1. 用管理员身份运行命令行。开始菜单 > 所有程序 > 附件，然后选择命令提示符，点击右键选择以管理员身份运行，打开命令行窗口。

2. 在命令提示符中设置变量，输入 set devmgr_show_nonpresent_devices=1，并按回车。

3. 接着在提示符中输入devmgmt.msc 启动设备管理器。

4. 在设备管理器中，点击菜单 View > Show hidden devices 以显示隐藏的没有连接到电脑上的设备名称。

5. 在设备管理器窗口左侧展开串口部分，将可以看到所有已被分配的COM口的设备列表。选择需要删除的串口设备，通过右键菜单> 卸载，便可以删除多余的设备。

 

另外，对于产线上的测试系统，用户并不希望所测试的设备COM口编号随着不同CP210x设备的接入而变化，需要固定使用同一COM口编号方便测试同类产品的不同设备，这时用户可以尝试通过修改注册表相关选项让Windows系统忽略指定的VID/PID设备的序列号。本文末附件提供了忽略CP2101/2/3/4， CP2105 和CP2108设备序列号的注册表文件，用户只需在测试系统上双击运行对应的注册表文件即可完成注册表的修改，忽略相应的CP210x设备的序列号，这样后续每次接入同类产品不同设备时，系统根据相同的VID/PID使用同一COM口编号。注意：用于USB3.0驱动的原因，通过修改注册表忽略系列号的方式对于连接到USB3.0接口的设备不起作用。

Knowledge Base Articles 接口 USB 桥接器
IgnoreHWSerNum_CP2105.zip

https://www.silabs.com/community/interface/knowledge-base.entry.html/2015/12/15/_com_-Aihi